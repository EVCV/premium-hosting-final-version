---
interface Props {
  title?: string;
  placeholder?: string;
  className?: string;
}

const { 
  title = "Find Your Perfect Domain",
  placeholder = "Enter your domain name",
  className = ""
} = Astro.props;
---

<div class={`domain-search-container ${className}`}>
  {title && (
    <div class="text-center mb-6">
      <h2 class="text-3xl font-medium mb-4">{title}</h2>
      <p class="text-gray-600">Search for available domains and secure your online presence</p>
    </div>
  )}
  
  <form id="domainSearchForm" class="domain-search-form">
    <div class="flex flex-col sm:flex-row gap-4 max-w-2xl mx-auto">
      <div class="flex-1 relative">
        <input
          type="text"
          name="domain"
          placeholder={placeholder}
          class="w-full px-6 py-4 text-lg border-2 border-gray-200 rounded-lg focus:border-gold focus:outline-none transition-all duration-300 hover:border-gray-300"
          required
        />
      </div>
      <button
        type="submit"
        class="btn-primary text-lg px-8 py-4 whitespace-nowrap hover:transform hover:scale-105 transition-all duration-300"
      >
        Search Domain
      </button>
    </div>
    
    <div class="flex flex-wrap gap-2 justify-center mt-6">
      <span class="text-sm text-gray-500">Popular extensions:</span>
      {['.com', '.net', '.org', '.co.uk', '.io'].map(ext => (
        <button
          type="button"
          class="domain-extension-btn text-sm px-3 py-1 border border-gray-300 rounded-md hover:border-gold hover:bg-gold hover:text-black transition-all duration-200"
          data-extension={ext}
        >
          {ext}
        </button>
      ))}
    </div>
  </form>
</div>

<style>
  .domain-search-container {
    background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(26, 0, 51, 0.05) 100%);
    padding: 3rem 2rem;
    border-radius: 20px;
    border: 1px solid rgba(212, 175, 55, 0.2);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    position: relative;
    overflow: hidden;
  }

  .domain-search-container::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(circle at 30% 20%, rgba(212, 175, 55, 0.1) 0%, transparent 50%);
    pointer-events: none;
  }

  .domain-extension-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(212, 175, 55, 0.3);
  }

  .domain-search-form {
    position: relative;
    z-index: 1;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const searchForm = document.getElementById('domainSearchForm');
    
    // Configuration: Change this to your actual Control Panel URL
    // Based on your old files, this seems to be the correct path:
    const searchUrl = "https://cp.premium-hosting.co.uk/domain-search"; 

    if (searchForm) {
      // Handle extension button clicks
      const extensionBtns = searchForm.querySelectorAll('.domain-extension-btn');
      const domainInput = searchForm.querySelector('input[name="domain"]') as HTMLInputElement;

      extensionBtns.forEach(btn => {
        btn.addEventListener('click', (e) => {
          e.preventDefault();
          const extension = (btn as HTMLElement).dataset.extension;
          if (extension && domainInput) {
            const currentValue = domainInput.value.trim();
            // Remove any existing extension and add the new one
            const baseDomain = currentValue.replace(/\.[a-zA-Z]{2,}$/, '');
            domainInput.value = baseDomain + extension;
            domainInput.focus();
          }
        });
      });

      // Handle form submission
      searchForm.addEventListener('submit', (e) => {
        // 1. Stop the form from doing a standard page reload
        e.preventDefault();

        // 2. Find the input field inside this specific form
        const inputField = searchForm.querySelector('input[name="domain"]') as HTMLInputElement;
        const domainName = inputField.value.trim();

        // 3. Check if the user actually typed something
        if (domainName) {
          // 4. Construct the URL securely
          // encodeURIComponent ensures special characters don't break the URL
          const finalUrl = `${searchUrl}?domain=${encodeURIComponent(domainName)}`;
          
          // 5. Redirect the user
          window.location.href = finalUrl;
        }
      });
    }
  });
</script>